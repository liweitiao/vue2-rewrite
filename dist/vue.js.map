{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/array.js","../src/observer/dep.js","../src/observer/index.js","../src/observer/scheduler.js","../src/observer/watcher.js","../src/state.js","../src/events.js","../src/vdom/patch.js","../src/lifecycle.js","../src/compiler/generate.js","../src/compiler/parser.js","../src/compiler/index.js","../src/inject.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/global-api/index.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n  return typeof val === 'function';\r\n}\r\n\r\nexport function isObject(val) {\r\n  return typeof val == 'object' && val !== null\r\n}\r\n\r\nexport const noop = () => {}\r\n\r\nexport function toArray (list) {\r\n  let i = list.length\r\n  const ret = new Array(i)\r\n  while (i--) {\r\n    ret[i] = list[i]\r\n  }\r\n  return ret\r\n}\r\n\r\n\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty\r\nexport function hasOwn(obj, key) {\r\n  return hasOwnProperty.call(obj, key)\r\n}\r\n\r\n\r\n\r\nconst callbacks = []\r\n\r\nfunction flushCallbacks() {\r\n  // console.log('utils---flushCallbacks---cbs--', callbacks)\r\n  callbacks.forEach(cb => {\r\n    // console.log('utils---flushCallbacks---cb---', cb)\r\n    cb()\r\n  })\r\n  waiting = false\r\n}\r\n\r\nlet waiting = false\r\n\r\nfunction timer(flushCallbacks) {\r\n  let timerFn = () => {}\r\n  if (Promise) {\r\n    timerFn = () => {\r\n      Promise.resolve().then(flushCallbacks)\r\n    }\r\n  } else if (MutationObserver) {\r\n    let textNode = document.createTextNode(1)\r\n    let observe = new MutationObserver(flushCallbacks)\r\n    observe.observe(textNode, {\r\n      characterData: true\r\n    })\r\n    timerFn = () => {\r\n      textNode.textContent = 3\r\n    }\r\n  } else if (setImmediate) {\r\n    timerFn = () => {\r\n      setImmediate(flushCallbacks)\r\n    }\r\n  } else {\r\n    timerFn = () => {\r\n      setTimeout(flushCallbacks)\r\n    }\r\n  }\r\n  timerFn()\r\n}\r\n\r\nexport function nextTick(cb) {\r\n  callbacks.push(cb)\r\n\r\n  if (!waiting) {\r\n    timer(flushCallbacks)\r\n    waiting = true\r\n  }\r\n}\r\n\r\nlet lifeCycleHooks = [\r\n  'beforeCreate',\r\n  'created',\r\n  'beforeMount',\r\n  'mounted',\r\n  'beforeUpdate',\r\n  'updated',\r\n  'beforeDestroy',\r\n  'destroyed',\r\n]\r\nlet strats = {}\r\n\r\nfunction mergeHook(parentVal, childVal) {\r\n  if (childVal) {\r\n    if (parentVal) {\r\n      return parentVal.concat(childVal)\r\n    } else {\r\n      return [childVal]\r\n    }\r\n  } else {\r\n    return parentVal\r\n  }\r\n}\r\n\r\nlifeCycleHooks.forEach(hook => {\r\n  strats[hook] = mergeHook\r\n})\r\n\r\nstrats.components = function(parentVal, childVal) {\r\n  // console.log('parentVal--childVal---', parentVal, childVal)\r\n  let options = Object.create(parentVal)\r\n  // console.log('utils--components---options--', options)\r\n  if (childVal) {\r\n    for (let key in childVal) {\r\n      options[key] = childVal[key]\r\n    }\r\n  }\r\n  return options\r\n}\r\n\r\nexport function mergeOptions(parent, child) {\r\n  const options = {}\r\n  for (let key in parent) {\r\n    mergeField(key)\r\n  }\r\n  for (let key in child) {\r\n    if (parent.hasOwnProperty(key)) {\r\n      continue\r\n    }\r\n    mergeField(key)\r\n  }\r\n\r\n  function mergeField(key) {\r\n    let parentVal = parent[key]\r\n    let childVal = child[key]\r\n    if (strats[key]) {\r\n      options[key] = strats[key](parentVal, childVal)\r\n    } else {\r\n      if (isObject(parentVal) && isObject(childVal)) {\r\n        options[key] = { ...parentVal, ...childVal }\r\n      } else {\r\n        options[key] = child[key] || parent[key]\r\n      }\r\n    }\r\n  }\r\n  return options\r\n}\r\n\r\nexport function isReservedTag(str) {\r\n  let reservedTag = 'a,div,span,p,img,button,ul,li';\r\n  // 源码根据 “，” 生成映射表 {a:true,div:true,p:true}\r\n  return reservedTag.includes(str);\r\n}\r\n","let oldArrayPrototype = Array.prototype\r\n// console.log(oldArrayPrototype.length)\r\nexport let arrayMethods = Object.create(oldArrayPrototype)\r\n// let arrayMethods = Object.create(oldArrayPrototype)\r\n\r\nlet methods = [\r\n  'push',\r\n  'shift',\r\n  'unshift',\r\n  'pop',\r\n  'reverse',\r\n  'sort',\r\n  'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n  arrayMethods[method] = function (...args) {\r\n    oldArrayPrototype[method].call(this, ...args)\r\n    let inserted\r\n    let ob = this.__ob__\r\n    switch (method) {\r\n      case 'push':\r\n      case 'unshift':\r\n        // console.log('unshift')\r\n        inserted = args\r\n        break\r\n      case 'splice':\r\n        // console.log('splice')\r\n        inserted = args.slice(2)\r\n      default: \r\n        break\r\n    }\r\n    if (inserted) ob.observeArray(inserted)\r\n\r\n    ob.dep.notify()\r\n  }\r\n})","let id = 0\r\nclass Dep {\r\n  constructor() {\r\n    this.id = id++\r\n    this.subs = []\r\n  }\r\n  depend() {\r\n    if (Dep.target) {\r\n      // console.log('dep----depend---this---', this)\r\n      Dep.target.addDep(this)\r\n    }\r\n  }\r\n  addSub(watcher) {\r\n    this.subs.push(watcher)\r\n  }\r\n  notify() {\r\n    // console.log('dep----notify----')\r\n    this.subs.forEach(watcher => watcher.update())\r\n  }\r\n}\r\nDep.target = null\r\n\r\nlet stack = []\r\n\r\nexport function pushTarget(watcher) {\r\n  Dep.target = watcher\r\n  stack.push(watcher)\r\n  // console.log(stack)\r\n}\r\n\r\nexport function popTarget(watcher) {\r\n  // Dep.target = null\r\n  stack.pop()\r\n  Dep.target = stack[stack.length - 1]\r\n  // console.log('dep--popTarget--Dep.target---', Dep.target)\r\n}\r\n\r\nexport default Dep","import { isObject } from '../utils'\r\nimport { arrayMethods } from './array'\r\nimport Dep from './dep'\r\n\r\nclass Observer {\r\n  constructor(data) {\r\n    this.dep = new Dep()\r\n    Object.defineProperty(data, '__ob__', {\r\n      value: this,\r\n      enumerable: false\r\n    })\r\n\r\n    if (Array.isArray(data)) {\r\n      data.__proto__ = arrayMethods\r\n      this.observeArray(data)\r\n    } else {\r\n      this.walk(data)\r\n    }\r\n  }\r\n\r\n  observeArray(data) {\r\n    data.forEach(item => observe(item))\r\n  }\r\n\r\n  walk(data) {\r\n    Object.keys(data).forEach(key => {\r\n      defineReactive(data, key, data[key])\r\n    })\r\n  }\r\n}\r\n\r\nfunction dependArray(value) {\r\n  for (let i = 0; i < value.length; i++) {\r\n    let current = value[i]\r\n    current.__ob__ && current.__ob__.dep.depend()\r\n    if (Array.isArray(current)) {\r\n      dependArray(current)\r\n    }\r\n  }\r\n}\r\n\r\nexport function defineReactive(data, key, value) {\r\n  let childOb = observe(value)\r\n  // console.log('observer---key---value--childOb---', key, value, childOb)\r\n  let dep = new Dep()\r\n  // console.log('observer---key---dep---', key, dep)\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      // console.log('get--')\r\n      if (Dep.target) {\r\n        console.log('observer---key---dep2---', key, dep)\r\n        dep.depend()\r\n        if (childOb) {\r\n          childOb.dep.depend()\r\n          if (Array.isArray(value)) {\r\n            dependArray(value)\r\n          }\r\n        }\r\n      }\r\n      return value\r\n    },\r\n    set(newValue) {\r\n      console.log('dep---newValue---', dep, newValue)\r\n      if (newValue !== value) {\r\n        observe(newValue)\r\n        value = newValue\r\n        // debugger\r\n        dep.notify()\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nexport function observe(data) {\r\n  if (!isObject(data)) {\r\n    return\r\n  }\r\n  if(data.__ob__) {\r\n    return data.__ob__\r\n  }\r\n\r\n  return new Observer(data)\r\n}","import { nextTick } from \"../utils\";\r\n\r\nlet queue = []\r\nlet has = {}\r\n\r\nfunction flushSchedulerQueue() {\r\n  for (let i = 0; i < queue.length; i++) {\r\n    queue[i].run()\r\n  }\r\n  queue = []\r\n  has = {}\r\n  pending = false\r\n}\r\n\r\n\r\nlet pending = false\r\n\r\nexport function queueWatcher(watcher) {\r\n  const id = watcher.id\r\n  if (has[id] == null) {\r\n    queue.push(watcher)\r\n    has[id] = true\r\n    if (!pending) {\r\n      nextTick(flushSchedulerQueue, 0)\r\n      pending = true\r\n    }\r\n  }\r\n}","import { popTarget, pushTarget } from \"./dep\";\r\nimport { queueWatcher } from './scheduler'\r\n\r\nlet id = 0\r\nclass Watcher {\r\n  constructor(vm, exprOrFn, cb, options) {\r\n    this.vm = vm\r\n    this.exprOrFn = exprOrFn\r\n    this.user = !!options.user\r\n    this.lazy = !!options.lazy\r\n    this.dirty = options.lazy\r\n    // console.log('dirty---', this.dirty)\r\n    this.cb = cb\r\n    this.options = options\r\n    this.id = id++\r\n    // this.getter = exprOrFn\r\n\r\n    if (typeof exprOrFn == 'string') {\r\n      this.getter = function() {\r\n        let path = exprOrFn.split('.')\r\n        let obj = vm\r\n        for (let i = 0; i < path.length; i++) {\r\n          obj = obj[path[i]]\r\n        }\r\n        // console.log('watcher---obj---', obj)\r\n        // console.log('exprOrFn---', exprOrFn)\r\n        return obj\r\n      }\r\n    } else {\r\n      // console.log('exprOrFn---', exprOrFn)\r\n      this.getter = exprOrFn\r\n    }\r\n\r\n    // console.log('watcher--getter---', this.getter)\r\n    this.deps = []\r\n    this.depsId = new Set()\r\n    // this.get()\r\n    this.value = this.lazy ? undefined : this.get()\r\n    // this.value = this.get()\r\n  }\r\n  get() {\r\n    pushTarget(this)\r\n    const value = this.getter.call(this.vm)\r\n    popTarget()\r\n\r\n    // console.log('watcher--get---value---', value)\r\n    return value\r\n  }\r\n  update() {\r\n    if (this.lazy) {\r\n      this.dirty = true\r\n      // console.log('update----')\r\n    } else {\r\n      // console.log('update22----')\r\n      queueWatcher(this)\r\n    }\r\n  }\r\n  run() {\r\n    let newValue = this.get()\r\n    let oldValue = this.value\r\n    this.value = newValue\r\n    if (this.user) {\r\n      this.cb.call(this.vm, newValue, oldValue)\r\n    }\r\n    // console.log('watcher---run---')\r\n  }\r\n  addDep(dep) {\r\n    let id = dep.id\r\n    if (!this.depsId.has(id)) {\r\n      this.depsId.add(id)\r\n      this.deps.push(dep)\r\n      dep.addSub(this)\r\n    }\r\n  }\r\n  evaluate() {\r\n    this.dirty = false\r\n    // console.log('watcher----dirty---', this.dirty)\r\n    this.value = this.get()\r\n  }\r\n  depend() {\r\n    let i = this.deps.length\r\n    while (i--) {\r\n      this.deps[i].depend()\r\n    }\r\n  }\r\n}\r\n\r\nexport default Watcher","import { isFunction, noop } from './utils'\r\nimport { observe } from './observer/index'\r\nimport Watcher from \"./observer/watcher\";\r\nimport Dep from './observer/dep'\r\n\r\nexport function stateMixin(Vue) {\r\n  Vue.prototype.$watch = function (key, handler, options = {}) {\r\n    options.user = true\r\n    // console.log('state---$watch---this---', this)\r\n    new Watcher(this, key, handler, options)\r\n  }\r\n}\r\n\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options\r\n  // console.log('state----opts---', opts)\r\n  if (opts.data) {\r\n    initData(vm)\r\n  }\r\n  if (opts.methods) {\r\n    initMethods(vm, opts.methods)\r\n  }\r\n  if (opts.watch) {\r\n    initWatch(vm, opts.watch)\r\n  }\r\n  if (opts.computed) {\r\n    initComputed(vm, opts.computed)\r\n  }\r\n}\r\n\r\nfunction proxy(vm, source, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[source][key]\r\n    },\r\n    set(newValue) {\r\n      vm[source][key] = newValue\r\n    }\r\n  })\r\n}\r\n\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data\r\n  data = vm._data = isFunction(data) ? data.call(vm) : data\r\n\r\n  for (let key in data) {\r\n    proxy(vm, '_data', key)\r\n  }\r\n\r\n  observe(data)\r\n}\r\n\r\nfunction initMethods(vm, methods) {\r\n  // console.log('initMethods---vm---methods---', vm, methods)\r\n  for (const key in methods) {\r\n    vm[key] = typeof methods[key] !== 'function' ? noop : methods[key].bind(vm)\r\n  }\r\n}\r\n\r\nfunction initWatch(vm, watch) {\r\n  for (let key in watch) {\r\n    let handler = watch[key]\r\n    // console.log('state---handler----', handler)\r\n    if (Array.isArray(handler)) {\r\n      for (let i = 0; i < handler.length; i++) {\r\n        createWatcher(vm, key, handler[i])\r\n      }\r\n    } else {\r\n      createWatcher(vm, key, handler)\r\n    }\r\n  }\r\n}\r\n\r\nfunction createWatcher(vm, key, handler) {\r\n  return vm.$watch(key, handler)\r\n}\r\n\r\nfunction initComputed(vm, computed) {\r\n  const watchers = vm._computedWatchers = {}\r\n  for (let key in computed) {\r\n    const userDef = computed[key]\r\n    let getter = typeof userDef == 'function' ? userDef : userDef.get\r\n\r\n    watchers[key] = new Watcher(vm, getter, () => {}, { lazy: true })\r\n\r\n    defineComputed(vm, key, userDef)\r\n  }\r\n}\r\n\r\nfunction createComputedGetter(key) {\r\n  // console.log('createComputed---')\r\n  return function computedGetter() {\r\n    let watcher = this._computedWatchers[key]\r\n    // console.log('state----createComputedGetter-key--watcher---',key, watcher)\r\n    if (watcher.dirty) {\r\n      watcher.evaluate()\r\n    }\r\n\r\n    // console.log('state----createComputed----Dep.target---', Dep.target)\r\n    if (Dep.target) {\r\n      watcher.depend()\r\n    }\r\n    return watcher.value\r\n  }\r\n  \r\n}\r\n\r\nfunction defineComputed(vm, key, userDef) {\r\n  let sharedProperty = {}\r\n  if (typeof userDef == 'function') {\r\n    sharedProperty.get = userDef\r\n  } else {\r\n    // sharedProperty.get = userDef.get\r\n    sharedProperty.get = createComputedGetter(key)\r\n    // sharedProperty.get()\r\n    sharedProperty.set = userDef.set\r\n  }\r\n  Object.defineProperty(vm, key, sharedProperty)\r\n}","/* @flow */\r\n\r\n// import {\r\n//   tip,\r\n//   toArray,\r\n//   hyphenate,\r\n//   formatComponentName,\r\n//   invokeWithErrorHandling\r\n// } from '../util/index'\r\n// import { updateListeners } from '../vdom/helpers/index'\r\nimport { toArray } from './utils'\r\n\r\n\r\nexport function initEvents (vm) {\r\n  vm._events = Object.create(null)\r\n}\r\n\r\nlet target\r\n\r\nfunction add (event, fn) {\r\n  target.$on(event, fn)\r\n}\r\n\r\nfunction remove (event, fn) {\r\n  target.$off(event, fn)\r\n}\r\n\r\nexport function eventsMixin (Vue) {\r\n  const hookRE = /^hook:/\r\n  Vue.prototype.$on = function (event, fn) {\r\n    console.log('$on----')\r\n    const vm = this\r\n    if (Array.isArray(event)) {\r\n      for (let i = 0, l = event.length; i < l; i++) {\r\n        vm.$on(event[i], fn)\r\n      }\r\n    } else {\r\n      (vm._events[event] || (vm._events[event] = [])).push(fn)\r\n    }\r\n    return vm\r\n  }\r\n\r\n  Vue.prototype.$once = function (event, fn) {\r\n    const vm = this\r\n    function on () {\r\n      vm.$off(event, on)\r\n      fn.apply(vm, arguments)\r\n    }\r\n    on.fn = fn\r\n    vm.$on(event, on)\r\n    return vm\r\n  }\r\n\r\n  Vue.prototype.$off = function (event, fn) {\r\n    const vm = this\r\n    if (!arguments.length) {\r\n      vm._events = Object.create(null)\r\n      return vm\r\n    }\r\n    // array of events\r\n    if (Array.isArray(event)) {\r\n      for (let i = 0, l = event.length; i < l; i++) {\r\n        vm.$off(event[i], fn)\r\n      }\r\n      return vm\r\n    }\r\n    // specific event\r\n    const cbs = vm._events[event]\r\n    if (!cbs) {\r\n      return vm\r\n    }\r\n    if (!fn) {\r\n      vm._events[event] = null\r\n      return vm\r\n    }\r\n    // specific handler\r\n    let cb\r\n    let i = cbs.length\r\n    while (i--) {\r\n      cb = cbs[i]\r\n      if (cb === fn || cb.fn === fn) {\r\n        cbs.splice(i, 1)\r\n        break\r\n      }\r\n    }\r\n    return vm\r\n  }\r\n\r\n  Vue.prototype.$emit = function (event) {\r\n    console.log('$emit----')\r\n    const vm = this\r\n    let cbs = vm._events[event]\r\n    if (cbs) {\r\n      cbs = cbs.length > 1 ? toArray(cbs) : cbs\r\n      const args = toArray(arguments, 1)\r\n      const info = `event handler for \"${event}\"`\r\n      for (let i = 0, l = cbs.length; i < l; i++) {\r\n        // invokeWithErrorHandling(cbs[i], vm, args, vm, info)\r\n        cbs[i].call(vm)\r\n      }\r\n    }\r\n    return vm\r\n  }\r\n}\r\n","\r\nexport function patch(oldVnode, vnode) {\r\n\r\n  if (!oldVnode) {\r\n    return createElm(vnode)\r\n  }\r\n\r\n  if (oldVnode.nodeType == 1) {\r\n    const parentElm = oldVnode.parentNode\r\n    let elm = createElm(vnode)\r\n    // console.log('patch----elm---', elm)\r\n    parentElm.insertBefore(elm, oldVnode.nextSibling)\r\n    parentElm.removeChild(oldVnode)\r\n\r\n    return elm\r\n  }\r\n}\r\n\r\nfunction createComponent(vnode) {\r\n  let i = vnode.data\r\n  if ((i = i.hook) && (i = i.init)) {\r\n    i(vnode)\r\n  }\r\n  if (vnode.componentInstance) {\r\n    return true\r\n  }\r\n}\r\n\r\nfunction createElm(vnode) {\r\n  // console.log('patch----vnode---', vnode)\r\n  let { tag, data, children, text, vm } = vnode\r\n  if (typeof tag === 'string') {\r\n    if (createComponent(vnode)) {\r\n      return vnode.componentInstance.$el\r\n    }\r\n\r\n    // debugger\r\n    vnode.el = document.createElement(tag)\r\n    children.forEach(child => {\r\n      vnode.el.appendChild(createElm(child))\r\n    })\r\n  } else {\r\n    vnode.el = document.createTextNode(text)\r\n  }\r\n  return vnode.el\r\n}","import { patch } from \"./vdom/patch\";\r\nimport Watcher from './observer/watcher'\r\nimport { nextTick } from \"./utils\";\r\n\r\nexport function lifecycleMixin(Vue) {\r\n  Vue.prototype._update = function(vnode) {\r\n    const vm = this\r\n    // debugger\r\n    vm.$el = patch(vm.$el, vnode)\r\n  }\r\n  Vue.prototype.$nextTick = nextTick\r\n}\r\n\r\nexport function initLifecycle(vm) {\r\n  const options = vm.$options\r\n\r\n  // locate first non-abstract parent\r\n  let parent = options.parent\r\n  if (parent && !options.abstract) {\r\n      while (parent.$options.abstract && parent.$parent) {\r\n          parent = parent.$parent\r\n      }\r\n      parent.$children.push(vm)\r\n  }\r\n\r\n  vm.$parent = parent\r\n  vm.$root = parent ? parent.$root : vm\r\n\r\n  vm.$children = []\r\n  vm.$refs = {}\r\n\r\n  vm._watcher = null\r\n  vm._inactive = null\r\n  vm._directInactive = false\r\n  vm._isMounted = false\r\n  vm._isDestroyed = false\r\n  vm._isBeingDestroyed = false\r\n}\r\n\r\nexport function mountComponent(vm, el) {\r\n  let updateComponent = () => {\r\n    let vnode = vm._render()\r\n    // console.log('lifecycle----mountComponent----vnode----', vnode)\r\n    vm._update(vnode)\r\n  }\r\n\r\n  callHook(vm, 'beforeMount')\r\n  new Watcher(vm, updateComponent, () => {\r\n    console.log('视图更新了！')\r\n  }, true)\r\n  // updateComponent()\r\n  callHook(vm, 'mounted')\r\n}\r\n\r\nexport function callHook(vm,hook){\r\n  let handlers = vm.$options[hook];\r\n  if(handlers){\r\n      for(let i =0; i < handlers.length;i++){\r\n          handlers[i].call(vm)\r\n      }\r\n  }\r\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{aaaaa}}\r\n\r\n\r\n// html字符串 =》 字符串  _c('div',{id:'app',a:1},'hello')\r\n\r\nfunction genProps(attrs) { // [{name:'xxx',value:'xxx'},{name:'xxx',value:'xxx'}]\r\n    let str = '';\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if (attr.name === 'style') { // color:red;background:blue\r\n            let styleObj = {};\r\n            attr.value.replace(/([^;:]+)\\:([^;:]+)/g, function() {\r\n                styleObj[arguments[1]] = arguments[2]\r\n            })\r\n            attr.value = styleObj\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`;\r\n    }\r\n    return `{${str.slice(0,-1)}}`\r\n}\r\n\r\nfunction gen(el) {\r\n    if (el.type == 1) { // element = 1 text = 3\r\n        return generate(el);\r\n    } else {\r\n        let text = el.text;\r\n        if (!defaultTagRE.test(text)) {\r\n            return `_v('${text}')`;\r\n        } else {\r\n            // 'hello' + arr + 'world'    hello {{arr}} {{aa}} world\r\n            let tokens = [];\r\n            let match;\r\n            let lastIndex = defaultTagRE.lastIndex = 0; // CSS-LOADER 原理一样\r\n            while (match = defaultTagRE.exec(text)) { // 看有没有匹配到\r\n                let index = match.index; // 开始索引\r\n                if (index > lastIndex) {\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`); // JSON.stringify()\r\n                lastIndex = index + match[0].length;\r\n            }\r\n            if (lastIndex < text.length) {\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            return `_v(${tokens.join('+')})`\r\n        }\r\n    }\r\n}\r\n\r\nfunction genChildren(el) {\r\n    let children = el.children; // 获取儿子\r\n    if (children) {\r\n        return children.map(c => gen(c)).join(',')\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function generate(el) { //  _c('div',{id:'app',a:1},_c('span',{},'world'),_v())\r\n    // 遍历树 将树拼接成字符串\r\n    let children = genChildren(el);\r\n    let code = `_c('${el.tag}',${\r\n        el.attrs.length? genProps(el.attrs): 'undefined'\r\n    }${\r\n        children? `,${children}`:''\r\n    })`;\r\n\r\n    return code;\r\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名 \r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //  用来获取的标签名的 match后的索引为1的\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配开始标签的 \r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配闭合标签的\r\n//           aa  =   \"  xxx \"  | '  xxxx '  | xxx\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // a=b  a=\"b\"  a='b'\r\nconst startTagClose = /^\\s*(\\/?)>/; //     />   <div/>\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{aaaaa}}\r\n\r\n\r\n\r\nexport function parserHTML(html) {\r\n\r\n    // ast (语法层面的描述 js css html) vdom （dom节点）\r\n\r\n    // html字符串解析成 对应的脚本来触发 tokens  <div id=\"app\"> {{name}}</div>\r\n    // 将解析后的结果 组装成一个树结构  栈\r\n    function createAstElement(tagName, attrs) {\r\n        return {\r\n            tag: tagName,\r\n            type: 1,\r\n            children: [],\r\n            parent: null,\r\n            attrs\r\n        }\r\n    }\r\n    let root = null;\r\n    let stack = [];\r\n\r\n    function start(tagName, attributes) {\r\n        let parent = stack[stack.length - 1];\r\n        let element = createAstElement(tagName, attributes);\r\n        if (!root) {\r\n            root = element;\r\n        }\r\n        if (parent) {\r\n            element.parent = parent; // 当放入栈中时 继续父亲是谁\r\n            parent.children.push(element)\r\n        }\r\n        stack.push(element);\r\n    }\r\n\r\n    function end(tagName) {\r\n        let last = stack.pop();\r\n        if (last.tag !== tagName) {\r\n            throw new Error('标签有误');\r\n        }\r\n    }\r\n\r\n    function chars(text) {\r\n        text = text.replace(/\\s/g, \"\");\r\n        let parent = stack[stack.length - 1];\r\n        if (text) {\r\n            parent.children.push({\r\n                type: 3,\r\n                text\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    function advance(len) {\r\n        html = html.substring(len);\r\n    }\r\n\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length);\r\n            let end;\r\n            // 如果没有遇到标签结尾就不停的解析\r\n            let attr;\r\n\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\r\n                advance(attr[0].length)\r\n            }\r\n            if (end) {\r\n                advance(end[0].length);\r\n            }\r\n            return match;\r\n        }\r\n        return false; // 不是开始标签\r\n    }\r\n    while (html) { // 看要解析的内容是否存在，如果存在就不停的解析\r\n        let textEnd = html.indexOf('<'); // 当前解析的开头  \r\n        if (textEnd == 0) {\r\n            const startTagMatch = parseStartTag(html); // 解析开始标签\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue;\r\n            }\r\n            const endTagMatch = html.match(endTag);\r\n            if (endTagMatch) {\r\n                end(endTagMatch[1]);\r\n                advance(endTagMatch[0].length);\r\n                continue;\r\n            }\r\n        }\r\n        let text; // //  </div>\r\n        if (textEnd > 0) {\r\n            text = html.substring(0, textEnd)\r\n        }\r\n        if (text) {\r\n            chars(text);\r\n            advance(text.length);\r\n        }\r\n    }\r\n\r\n    return root;\r\n}\r\n\r\n\r\n// 看一下用户是否传入了 , 没传入可能传入的是 template, template如果也没有传递\r\n// 将我们的html =》 词法解析  （开始标签 ， 结束标签，属性，文本）\r\n// => ast语法树 用来描述html语法的 stack=[]\r\n\r\n// codegen  <div>hello</div>  =>   _c('div',{},'hello')  => 让字符串执行\r\n// 字符串如果转成代码 eval 好性能 会有作用域问题\r\n\r\n// 模板引擎 new Function + with 来实现","import { generate } from './generate';\r\nimport {parserHTML} from './parser';\r\n\r\nexport function compileToFunction(template) {\r\n    let root = parserHTML(template)\r\n    \r\n    // 生成代码 \r\n    let code = generate(root)\r\n\r\n    let render = new Function(`with(this){return ${code}}`); // code 中会用到数据 数据在vm上\r\n\r\n    return render;\r\n    // render(){\r\n    //     return\r\n    // }\r\n    // html=> ast（只能描述语法 语法不存在的属性无法描述） => render函数 + (with + new Function) => 虚拟dom （增加额外的属性） => 生成真实dom\r\n}\r\n","import { hasOwn } from './utils'\r\nimport { defineReactive } from './observer/index'\r\n\r\nexport function initProvide(vm) {\r\n  const provide = vm.$options.provide\r\n  console.log('inject----provide--', provide)\r\n  if (provide) {\r\n    vm._provided = typeof provide === 'function' ? provide.call(vm) : provide\r\n  }\r\n}\r\n\r\n\r\nexport function initInjections(vm) {\r\n  const result = resolveInject(vm.$options.inject, vm)\r\n  console.log('inject---initInjections---result---', result)\r\n  if (result) {\r\n    Object.keys(result).forEach(key => {\r\n      defineReactive(vm, key, result[key])\r\n    })\r\n  }\r\n}\r\n\r\nexport function resolveInject(inject, vm) {\r\n  // debugger\r\n  if (inject) {\r\n    const result = Object.create(null)\r\n    // const keys = Object.keys(inject)\r\n    const keys = Reflect.ownKeys(inject)\r\n    console.log('inject----resolveInject----result---', keys)\r\n\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const key = keys[i]\r\n      if (key === '__ob__') continue\r\n      const provideKey = inject[key]\r\n      let source = vm\r\n      while (source) {\r\n        if (source._provided && hasOwn(source._provided, provideKey)) {\r\n          result[inject[key]] = source._provided[provideKey]\r\n          break\r\n        }\r\n        source = source.$parent\r\n      }\r\n      if (!source) {\r\n        console.log('inject---key---', inject, key)\r\n        if (key !== 'length' && 'default' in inject[key]) {\r\n          const provideDefault = inject[key].default\r\n          result[key] = typeof provideDefault === 'function'\r\n            ? provideDefault.call(vm)\r\n            : provideDefault\r\n        }\r\n      }\r\n    }\r\n\r\n    return result\r\n  }\r\n}","import { initState } from './state'\r\nimport { initEvents } from './events'\r\nimport { callHook, mountComponent, initLifecycle } from \"./lifecycle\"\r\nimport { compileToFunction } from \"./compiler/index\";\r\nimport { mergeOptions } from './utils'\r\nimport { initInjections, initProvide } from './inject'\r\n\r\nlet uid = 0\r\n\r\nexport function initMixin(Vue) {\r\n  // console.log('initMixin----')\r\n  Vue.prototype._init = function(options) {\r\n    const vm = this\r\n    vm._uid = uid++\r\n    vm.$options = mergeOptions(vm.constructor.options, options)\r\n\r\n    // console.log('init---vm.$options---', vm.$options)\r\n    initLifecycle(vm)\r\n    initEvents(vm)\r\n    callHook(vm, 'beforeCreate')\r\n    // debugger\r\n    initInjections(vm)\r\n    initState(vm)\r\n    initProvide(vm)\r\n    callHook(vm, 'created')\r\n\r\n    if (vm.$options.el) {\r\n      // debugger\r\n      vm.$mount(vm.$options.el)\r\n    }\r\n  }\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    // console.log('$mount----el---', el)\r\n    const vm = this\r\n    const options = vm.$options\r\n    el = document.querySelector(el)\r\n    vm.$el = el\r\n    if (!options.render) {\r\n      let template = options.template\r\n      if (!template && el) {\r\n        template = el.outerHTML\r\n        // console.log('template---', template)\r\n      }\r\n      let render = compileToFunction(template)\r\n      options.render = render\r\n    }\r\n    // debugger\r\n    mountComponent(vm, el)\r\n  }\r\n}","import { isReservedTag, isObject } from \"../utils\";\r\n\r\nexport function createElement(vm, tag, data = {}, ...children) {\r\n  // console.log('vdom---tag---data--', tag, data)\r\n  if (isReservedTag(tag)) {\r\n    return vnode(vm, tag, data, data.key, children, undefined);\r\n  } else {\r\n    const Ctor = vm.$options.components[tag]\r\n    return createComponent(vm, tag, data, data.key, children, Ctor)\r\n  }\r\n}\r\n\r\nfunction createComponent(vm, tag, data, key, children, Ctor) {\r\n  // console.log('vdom---createComponent---Ctor---', Ctor)\r\n  if (isObject(Ctor)) {\r\n    Ctor = vm.$options._base.extend(Ctor)\r\n  }\r\n  data.hook = {\r\n    init(vnode) {\r\n      // debugger\r\n      let child = vnode.componentInstance = new Ctor({_isComponent: true, parent: vm})\r\n\r\n      // debugger\r\n      child.$mount()\r\n    }\r\n  }\r\n  // console.log('vdom---createComponent---Ctor---', Ctor)\r\n  // console.log(vnode(vm, `vue-component-${tag}`, data, key, undefined, undefined, {Ctor, children}))\r\n  return vnode(vm, `vue-component-${tag}`, data, key, undefined, undefined, {Ctor, children})\r\n}\r\n\r\nexport function createTextElement(vm, text) {\r\n  return vnode(vm, undefined, undefined, undefined, undefined, text);\r\n}\r\n\r\nfunction vnode(vm, tag, data, key, children, text, componentOptions) {\r\n  return {\r\n      vm,\r\n      tag,\r\n      data,\r\n      key,\r\n      children,\r\n      text,\r\n      componentOptions\r\n      // .....\r\n  }\r\n}","import { createElement, createTextElement } from \"./vdom/index\"\r\n\r\nexport function renderMixin(Vue) {\r\n  // console.log('renderMixin---')\r\n  Vue.prototype._c = function() {\r\n    return createElement(this, ...arguments)\r\n  }\r\n\r\n  Vue.prototype._v = function (text) {\r\n    return createTextElement(this, text)\r\n  }\r\n\r\n  Vue.prototype._s = function(val) {\r\n    if (typeof val === 'object') return JSON.stringify(val)\r\n    return val\r\n  }\r\n\r\n  Vue.prototype._render = function () {\r\n    const vm = this\r\n    let render = vm.$options.render\r\n    let vnode = render.call(vm)\r\n    return vnode\r\n  }\r\n}","import { mergeOptions } from '../utils'\r\n\r\nexport function initGlobalApi(Vue) {\r\n  Vue.options = {}\r\n  Vue.mixin = function(options) {\r\n    this.options = mergeOptions(this.options, options)\r\n    // console.log('initGlobal-----options----', this.options)\r\n    return this\r\n  }\r\n\r\n  Vue.options._base = Vue\r\n  Vue.options.components = {}\r\n  Vue.component = function (id, definition) {\r\n    definition = this.options._base.extend(definition)\r\n    // console.log('global-api----component---definition---', definition)\r\n    this.options.components[id] = definition\r\n  }\r\n\r\n  Vue.extend = function (opts) {\r\n    const Super = this\r\n    const Sub = function VueComponent(options) {\r\n      this._init(options)\r\n    }\r\n    Sub.prototype = Object.create(Super.prototype)\r\n    Sub.prototype.constructor = Sub\r\n    Sub.options = mergeOptions(Super.options, opts)\r\n    // console.log('global-api----extend----Sub.options---', Sub.options)\r\n    return Sub\r\n  }\r\n}","import { initMixin } from './init'\r\nimport { renderMixin } from './render'\r\nimport { lifecycleMixin } from \"./lifecycle\"\r\nimport { stateMixin } from './state'\r\nimport { eventsMixin } from './events'\r\nimport { initGlobalApi } from './global-api/index'\r\n\r\n\r\n\r\nfunction Vue(options) {\r\n  // console.log('Vue---')\r\n  this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\neventsMixin(Vue)\r\nrenderMixin(Vue)\r\nlifecycleMixin(Vue)\r\nstateMixin(Vue)\r\n\r\ninitGlobalApi(Vue)\r\n\r\nexport default Vue"],"names":["isFunction","val","isObject","noop","toArray","list","i","length","ret","Array","hasOwnProperty","Object","prototype","hasOwn","obj","key","call","callbacks","flushCallbacks","forEach","cb","waiting","timer","timerFn","Promise","resolve","then","MutationObserver","textNode","document","createTextNode","observe","characterData","textContent","setImmediate","setTimeout","nextTick","push","lifeCycleHooks","strats","mergeHook","parentVal","childVal","concat","hook","components","options","create","mergeOptions","parent","child","mergeField","isReservedTag","str","reservedTag","includes","oldArrayPrototype","arrayMethods","methods","method","args","inserted","ob","__ob__","slice","observeArray","dep","notify","id","Dep","constructor","subs","depend","target","addDep","addSub","watcher","update","stack","pushTarget","popTarget","pop","Observer","data","defineProperty","value","enumerable","isArray","__proto__","walk","item","keys","defineReactive","dependArray","current","childOb","get","console","log","set","newValue","queue","has","flushSchedulerQueue","run","pending","queueWatcher","Watcher","vm","exprOrFn","user","lazy","dirty","getter","path","split","deps","depsId","Set","undefined","oldValue","add","evaluate","stateMixin","Vue","$watch","handler","initState","opts","$options","initData","initMethods","watch","initWatch","computed","initComputed","proxy","source","_data","bind","createWatcher","watchers","_computedWatchers","userDef","defineComputed","createComputedGetter","computedGetter","sharedProperty","initEvents","_events","eventsMixin","$on","event","fn","l","$once","on","$off","apply","arguments","cbs","splice","$emit","patch","oldVnode","vnode","createElm","nodeType","parentElm","parentNode","elm","insertBefore","nextSibling","removeChild","createComponent","init","componentInstance","tag","children","text","$el","el","createElement","appendChild","lifecycleMixin","_update","$nextTick","initLifecycle","abstract","$parent","$children","$root","$refs","_watcher","_inactive","_directInactive","_isMounted","_isDestroyed","_isBeingDestroyed","mountComponent","updateComponent","_render","callHook","handlers","defaultTagRE","genProps","attrs","attr","name","styleObj","replace","JSON","stringify","gen","type","generate","test","tokens","match","lastIndex","exec","index","trim","join","genChildren","map","c","code","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parserHTML","html","createAstElement","tagName","root","start","attributes","element","end","last","Error","chars","advance","len","substring","parseStartTag","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunction","template","render","Function","initProvide","provide","_provided","initInjections","result","resolveInject","inject","Reflect","ownKeys","provideKey","provideDefault","default","uid","initMixin","_init","_uid","$mount","querySelector","outerHTML","Ctor","_base","extend","_isComponent","createTextElement","componentOptions","renderMixin","_c","_v","_s","initGlobalApi","mixin","component","definition","Super","Sub","VueComponent"],"mappings":"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"}